# ü¶† Malware Detection Testing Guide

**Author:** Manoj Santhoju  
**Institution:** National College of Ireland  
**Program:** MSc Cybersecurity

**‚ö†Ô∏è IMPORTANT:** This guide is for **EDUCATIONAL PURPOSES ONLY**. The malware simulation script creates **safe, benign behaviors** that mimic malware patterns for testing your memory forensics framework. It does **NOT contain actual malware**.

## üìã Overview

This guide will help you:
1. **Simulate malware-like behaviors** safely
2. **Create memory dumps** during/after simulation
3. **Test your framework's malware detection** capabilities
4. **Clean up** test artifacts safely

## üéØ Step-by-Step Testing Process

### **Step 1: Prepare Test Environment**

#### Windows
```cmd
# Activate virtual environment
venv\Scripts\activate

# Verify framework is ready
py -m unified_forensics info
```

#### Linux/macOS
```bash
# Activate virtual environment
source venv/bin/activate

# Verify framework is ready
python3 -m unified_forensics info
```

### **Step 2: Run Malware Simulation**

The simulation script will create:
- ‚úÖ Suspicious file operations (create, modify, copy, rename)
- ‚úÖ Suspicious process behaviors
- ‚úÖ Network connection attempts
- ‚úÖ Registry/configuration modifications (Windows)

#### Windows
```cmd
py test_malware_simulation.py
```

#### Linux/macOS
```bash
python3 test_malware_simulation.py
```

**Expected Output:**
```
[*] Creating isolated test environment...
[+] Test environment created: malware_test_environment
[*] Simulating suspicious file operations...
[+] Created: malware_test_environment/suspicious_encrypted.dat
[+] Created: malware_test_environment/temp_credentials.txt
...
[*] Simulating suspicious process behaviors...
[+] Started suspicious process: PID 12345
...
[+] Test report generated: malware_test_environment/malware_simulation_report.txt
```

### **Step 3: Create Memory Dump**

**‚ö†Ô∏è IMPORTANT:** You need to create a memory dump **while the simulation is running** or **immediately after** to capture the malicious activities.

#### Option A: Using Windows Built-in Tools (Windows)

```cmd
# Using WinPmem (if installed)
winpmem.exe -o memory_dump_with_malware.raw

# Or using DumpIt (if installed)
dumpit.exe /O memory_dump_with_malware.raw
```

#### Option B: Using Volatility (All Platforms)

If you have Volatility installed and can create live dumps:
```bash
# Linux
sudo volatility3 -f /dev/mem -o memory_dump_with_malware.raw

# Note: This requires root/sudo access
```

#### Option C: Using Virtual Machine (Recommended)

**Best Practice:** Run the simulation in a VM, then create a VM memory dump:
1. **VMware:** Use `vmware-vmx.exe --dumpvm` or VMware's snapshot feature
2. **VirtualBox:** Use `VBoxManage debugvm <vm-name> dumpvmcore --filename dump.elf`
3. **Hyper-V:** Use `Save-VM` command or checkpoint feature

#### Option D: Simulated Dump (For Testing)

If you don't have access to real memory dumping tools, you can use the framework's test dump generator with enhanced malicious signatures:

```cmd
# Windows
py quick_sample_generator.py
# Then analyze the generated sample

# Linux/macOS
python3 quick_sample_generator.py
```

### **Step 4: Analyze Memory Dump with Framework**

Once you have the memory dump, analyze it with your framework:

#### Windows
```cmd
# Basic analysis with malware plugin
py -m unified_forensics analyze memory_dump_with_malware.raw --os-type windows --plugins malware --format summary --metrics

# Or with experimental analysis
py -m unified_forensics experiment memory_dump_with_malware.raw --os-type windows --rates 1 --rates 10
```

#### Linux/macOS
```bash
# Basic analysis with malware plugin
python3 -m unified_forensics analyze memory_dump_with_malware.raw --os-type linux --plugins malware --format summary --metrics

# Or with experimental analysis
python3 -m unified_forensics experiment memory_dump_with_malware.raw --os-type linux --rates 1 --rates 10
```

### **Step 5: Review Detection Results**

Check the analysis results:

```cmd
# Windows
type analysis_results\*.json

# Linux/macOS
cat analysis_results/*.json
```

Look for:
- ‚úÖ **Suspicious processes** detected
- ‚úÖ **Suspicious file operations** identified
- ‚úÖ **Network connections** flagged
- ‚úÖ **Detection metrics** showing malware detection rate

### **Step 6: Clean Up Test Environment**

#### Windows
```cmd
py test_malware_simulation.py --cleanup
```

#### Linux/macOS
```bash
python3 test_malware_simulation.py --cleanup
```

Or use the automated cleanup script:
```cmd
# Windows
cleanup_malware_test.bat

# Linux/macOS
./cleanup_malware_test.sh
```

## üîÑ Automated Testing Workflow

### Quick Test Script (All Platforms)

Use the automated test script for a complete workflow:

#### Windows
```cmd
test_malware_detection.bat
```

#### Linux/macOS
```bash
./test_malware_detection.sh
```

This script will:
1. ‚úÖ Run malware simulation
2. ‚úÖ Generate test report
3. ‚úÖ Wait for memory dump creation (manual step)
4. ‚úÖ Analyze the dump with framework
5. ‚úÖ Display results
6. ‚úÖ Optionally clean up

## üìä Expected Detection Results

Your framework should detect:

### ‚úÖ File Operations
- **Created files:** `suspicious_encrypted.dat`, `temp_credentials.txt`
- **Modified files:** Multiple rapid modifications
- **Copied files:** File copies indicating data theft
- **Renamed files:** Evasion attempts

### ‚úÖ Process Behaviors
- **Suspicious processes:** Python scripts with network/file operations
- **Process IDs:** Tracked in memory dump
- **Process chains:** Process creation patterns

### ‚úÖ Network Activity
- **Connection attempts:** Ports 8080, 4444, 5555, 6666
- **Socket creation:** Network socket operations
- **Failed connections:** Connection attempts to localhost

### ‚úÖ Registry/Config Modifications
- **Registry changes:** Windows registry modifications
- **Config files:** Configuration file alterations

## üéì Academic Testing Scenarios

### Scenario 1: Data Exfiltration Simulation
```bash
# Run simulation
python3 test_malware_simulation.py

# Create memory dump (use your preferred method)

# Analyze
python3 -m unified_forensics analyze dump.raw --os-type linux --plugins malware,network --metrics
```

### Scenario 2: Malware Persistence Simulation
```bash
# Run simulation (will create persistent files)
python3 test_malware_simulation.py

# Create memory dump after system restart simulation

# Analyze for persistence mechanisms
python3 -m unified_forensics analyze dump.raw --os-type windows --plugins malware
```

### Scenario 3: Network-Based Malware
```bash
# Run simulation (emphasizes network activity)
python3 test_malware_simulation.py

# Capture during network activity

# Analyze network connections
python3 -m unified_forensics analyze dump.raw --os-type linux --plugins network --metrics
```

## üîç Verification Checklist

After testing, verify:

- [ ] Malware simulation ran successfully
- [ ] Memory dump created successfully
- [ ] Framework analysis completed
- [ ] Detection metrics calculated
- [ ] Suspicious files identified
- [ ] Suspicious processes detected
- [ ] Network activity flagged
- [ ] Test report generated
- [ ] Cleanup completed (if desired)

## ‚ö†Ô∏è Safety Warnings

1. **Isolated Environment:** Always run in a VM or isolated system
2. **No Real Malware:** The simulation script is safe but still use caution
3. **Backup First:** Backup your system before testing
4. **Network Isolation:** Disconnect from network if testing network behaviors
5. **Academic Use Only:** This is for educational/testing purposes only

## üìù Test Report Template

After completing tests, document:

```markdown
## Malware Detection Test Report

**Date:** [Date]
**Platform:** [Windows/Linux/macOS]
**Framework Version:** [Version]

### Test Results
- Files Detected: [X]
- Processes Detected: [X]
- Network Connections: [X]
- Detection Rate: [X%]

### False Positives
- [List any false positives]

### False Negatives
- [List any missed detections]

### Recommendations
- [Improvements needed]
```

## üöÄ Next Steps

1. **Run Multiple Tests:** Test with different scenarios
2. **Compare Results:** Compare detection rates across platforms
3. **Document Findings:** Create test report for professor
4. **Improve Detection:** Use results to enhance framework
5. **Prepare Presentation:** Use results for academic presentation

---

**‚úÖ Ready to test your malware detection capabilities!**

Remember: This is for **educational purposes only**. Always use isolated environments and follow your institution's security policies.
